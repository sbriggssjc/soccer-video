Running: C:\Users\scott\AppData\Local\Programs\Python\Python313\python.exe D:\Projects\soccer-video\tools\render_follow_unified.py --preset cinematic --in D:\Projects\soccer-video\out\atomic_clips\2026-02-23__TSC_vs_NEOFC\002__2026-02-23__TSC_vs_NEOFC__BUILD_AND_SHOTS__t17.00-t32.00.mp4 --out D:\Projects\soccer-video\out\portrait_reels\2026-02-23__TSC_vs_NEOFC\002__pipeline_v9.mp4 --portrait 1080x1920 --no-draw-ball --diagnostics
[INFO] [MOTION] Generating motion-centroid telemetry at out\telemetry\002__2026-02-23__TSC_vs_NEOFC__BUILD_AND_SHOTS__t17.00-t32.00.ball.jsonl
[MOTION] Generating full-clip motion telemetry for 002__2026-02-23__TSC_vs_NEOFC__BUILD_AND_SHOTS__t17.00-t32.00.mp4 (496 frames, 16.5s)...
[MOTION] Source-camera pan detected on 325/496 frames — compensating
[MOTION] Global detections: 396/496 frames
[MOTION] Stitched path: 496/496 frames
[MOTION] Telemetry complete: 496 frames, cx=[247, 1755], lookahead=0.60s
[INFO] [BALL-TELEMETRY] ball_src_x=[247.2, 1754.7], ball_src_y=[709.0, 1014.9], kept=496/496, conf=0.84
[INFO] [BALL-CAM RAW] N=496, ball_cx_range=[247.2, 1754.7], ball_cy_range=[709.0, 1014.9], vpos=0.55
[INFO] [BALL-CAM STRICT] N=496, cx_range=[304.0, 1616.0], cy_range=[540.0, 540.0], lead_frames=3, smooth_window=5, max_speed_px=120.0, margin=80.0, vpos=0.60
[INFO] [BALL-CAM COVERAGE] ball_in_crop: 100.0% (496/496), strict_with_margin: 77.2% (383/496)
[INFO] [BALL-CAM] coverage: 100.0% (conf=0.84, quality=0.79), path: 496 frames, cx range=[304.0, 1616.0], jerk95_raw=4042.1, jerk95_cam=5818.7 px/s^3
[INFO] [BALL-CAM] ball_in_crop_horiz: 100.0% (496/496)
[INFO] [PLANNER] Using YOLO+centroid fusion: 496/496 frames covered, avg confidence=0.35
[INFO] [TRACKER] CSRT filled 147 gap frames with real pixel data
[INFO] [PLANNER] Position smoothing: 496 frames (231 high-conf protected), max delta 1602.4->776.1 px/frame
[INFO] [TRAJ-SMOOTH] Velocity-adaptive Gaussian (sigma=8): 6% of frames heavily smoothed, v_range=[0.0, 776.1] px/f
[INFO] [POST-SMOOTH] Ball-in-crop guarantee: adjusted 26/496 frames (margin=60px)
[INFO] [POST-SMOOTH] BIC re-applied after smooth: 9 frames
[INFO] [POST-SMOOTH] BIC convergence pass: 9 frames
[INFO] [CINEMA-SMOOTH] Final smooth pass (sigma=3.0) applied to 496 frames
[INFO] [PAN] CameraPlanner driving panning directly (Option C disabled)
[INFO] [PAN-DEBUG] src=(1920,1080) portrait_target=(608.0,1080.0) scale_x=0.3167 offset_x=0.00
[INFO] [STAB] Stabilisation active: 496 frames, peak_y=11.4px, peak_x=40.0px, overscan=1.027
[YOLO] Loaded 59 cached YOLO detections from out\telemetry\002__2026-02-23__TSC_vs_NEOFC__BUILD_AND_SHOTS__t17.00-t32.00.yolo_ball.jsonl
[FUSION] v22r: dropped 1 targeted false YOLO: [332]
[FUSION] Sparse YOLO (11.7%): lowered conf_threshold to 0.18
[FUSION] Sparse YOLO (11.7%): gating stale_frames=43, hold_blend=0.47
[FUSION] 496/496 frames covered (100.0%): yolo=58, centroid=438, blended=0, avg_conf=0.26
[FUSION] Sparse YOLO: extended LONG_INTERP_GAP 90->109 frames
[FUSION] Pan-hold: frames 431->466 (35 frames), holding near x=111 (endpoint x=1713 ignored, dist=1602px)
[FUSION] Backward-hold: filled 25 leading frames from first YOLO at frame 25
[FUSION] Interpolated 276 frames between YOLO detections (short_gap=15, long_gap=109) (long-flight=125)
[FUSION] Velocity extrapolation: filled 78 frames during high-speed ball flight (speed_thr=4.0 px/f, decel=0.920, fps_scale=1.00)
[FUSION] YOLO-anchor blend: adjusted 84 centroid frames (density=11.7%, range=90f, max_disp=200px, capped=19)
[FUSION] Long-flight: frames 45->69 (t=1.5s->2.3s, 24 frames), ball x=475->708 (233px) [linear]
[FUSION] Long-flight: frames 69->95 (t=2.3s->3.2s, 26 frames), ball x=708->850 (143px) [linear]
[FUSION] Long-flight: frames 126->144 (t=4.2s->4.8s, 18 frames), ball x=888->1410 (536px) [ease_out]
[FUSION] Long-flight: frames 144->171 (t=4.8s->5.7s, 27 frames), ball x=1410->1681 (352px) [linear]
[FUSION] Long-flight: frames 431->466 (t=14.4s->15.5s, 35 frames), ball x=111->1713 (1602px) [pan_hold]
[FUSION] Ball x timeline (1s steps): f0=461, f30=745, f60=620, f90=823, f120=886, f150=1470, f180=1521, f210=1449, f240=1378, f270=1764, f300=1784, f330=1468, f360=1329, f390=634, f420=222, f450=111, f480=407, f495=81
[TRACKER] Loaded 147 cached tracker positions from out\telemetry\002__2026-02-23__TSC_vs_NEOFC__BUILD_AND_SHOTS__t17.00-t32.00.tracker_ball.jsonl
[YOLO] Loaded 6127 cached person detections (496 frames) from out\telemetry\002__2026-02-23__TSC_vs_NEOFC__BUILD_AND_SHOTS__t17.00-t32.00.yolo_person.jsonl
[DEBUG] num_frames=496 fps=30.0 positions=496 duration=16.533333333333335
[DEBUG] ball_samples=496
[GLOBAL-PATH] Legacy Gaussian: replaced 484/496 frames, mean_delta=13.6px/f, max_delta=179.4px/f
[CAMERA] Speed limiter (preset): clamped 29/496 frames (max 50.0px/f = 1500px/s, trans=75.0px/f, catchup=60.0px/f)
[CAMERA] cx: range=1262px, max_delta=50.0px/f, mean_delta=9.9px/f, p95_delta=50.0px/f, reversals=17, deadzone_hold=12%, still=27%
[CAMERA] zoom: range=0.03, max_delta=0.0060/f, mean_delta=0.0003/f, reversals=12, person_ctx=43f, flight=474f
[DIAG] Ball in crop: 492/496 (99.2%) | Outside: 4 frames | Max escape: 464px
[DIAG] Source breakdown: yolo=58(1 out/2%), centroid=84(0 out/0%), interp=147(3 out/2%), hold=26(0 out/0%), shot_hold=34(0 out/0%), tracker=147(0 out/0%)
[DIAG] WARNING: 291/496 frames (59%) use synthetic positions (interp=147, hold=26, shot_hold=34, centroid=84). Ball-in-crop metric is unreliable — actual ball may be outside the crop.
[DIAG] YOLO-only ball in crop: 57/205 (27.8%) | Interpolated/held frames (not checked): 173
[DIAG] Speed-limited: 10f (2%) | Keepinview: 157f (32%)
[DIAG] Confidence-weighted ball-in-crop: 99.5% (weighted frames: 222/496)
[DIAG] Camera cx timeline (1s): f0=462, f30=694, f60=624, f90=814, f120=872, f150=1470, f180=1521, f210=1454, f240=1407, f270=1591, f300=1591, f330=1471, f360=1332, f390=659, f420=329, f450=329, f480=691, f495=329
[DIAG] Worst escapes: f466:464px(yolo), f467:424px(interp), f468:290px(interp), f469:141px(interp)
[DIAG] Per-frame CSV: D:\Projects\soccer-video\out\portrait_reels\2026-02-23__TSC_vs_NEOFC\002__pipeline_v9.diag.csv
ffmpeg version 8.0-full_build-www.gyan.dev Copyright (c) 2000-2025 the FFmpeg developers
  built with gcc 15.2.0 (Rev8, Built by MSYS2 project)
  configuration: --enable-gpl --enable-version3 --enable-static --disable-w32threads --disable-autodetect --enable-fontconfig --enable-iconv --enable-gnutls --enable-lcms2 --enable-libxml2 --enable-gmp --enable-bzlib --enable-lzma --enable-libsnappy --enable-zlib --enable-librist --enable-libsrt --enable-libssh --enable-libzmq --enable-avisynth --enable-libbluray --enable-libcaca --enable-libdvdnav --enable-libdvdread --enable-sdl2 --enable-libaribb24 --enable-libaribcaption --enable-libdav1d --enable-libdavs2 --enable-libopenjpeg --enable-libquirc --enable-libuavs3d --enable-libxevd --enable-libzvbi --enable-liboapv --enable-libqrencode --enable-librav1e --enable-libsvtav1 --enable-libvvenc --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxeve --enable-libxvid --enable-libaom --enable-libjxl --enable-libvpx --enable-mediafoundation --enable-libass --enable-frei0r --enable-libfreetype --enable-libfribidi --enable-libharfbuzz --enable-liblensfun --enable-libvidstab --enable-libvmaf --enable-libzimg --enable-amf --enable-cuda-llvm --enable-cuvid --enable-dxva2 --enable-d3d11va --enable-d3d12va --enable-ffnvcodec --enable-libvpl --enable-nvdec --enable-nvenc --enable-vaapi --enable-libshaderc --enable-vulkan --enable-libplacebo --enable-opencl --enable-libcdio --enable-openal --enable-libgme --enable-libmodplug --enable-libopenmpt --enable-libopencore-amrwb --enable-libmp3lame --enable-libshine --enable-libtheora --enable-libtwolame --enable-libvo-amrwbenc --enable-libcodec2 --enable-libilbc --enable-libgsm --enable-liblc3 --enable-libopencore-amrnb --enable-libopus --enable-libspeex --enable-libvorbis --enable-ladspa --enable-libbs2b --enable-libflite --enable-libmysofa --enable-librubberband --enable-libsoxr --enable-chromaprint --enable-whisper
  libavutil      60.  8.100 / 60.  8.100
  libavcodec     62. 11.100 / 62. 11.100
  libavformat    62.  3.100 / 62.  3.100
  libavdevice    62.  1.100 / 62.  1.100
  libavfilter    11.  4.100 / 11.  4.100
  libswscale      9.  1.100 /  9.  1.100
  libswresample   6.  1.100 /  6.  1.100
Input #0, image2, from 'D:\Projects\soccer-video\out\_scratch\002__2026_02_23__TSC_vs_NEOFC__B_6180b164\autoframe_work\cinematic\002__2026-02-23__TSC_vs_NEOFC__BUILD_AND_SHOTS__t17.00-t32.00\frames\frame_%06d.png':
  Duration: 00:00:16.53, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgb24(pc, gbr/unknown/unknown), 1080x1920, 30 fps, 30 tbr, 30 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0000025689dd7380] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0000025689dd7380] profile High, level 5.0, 4:2:0, 8-bit
[libx264 @ 0000025689dd7380] 264 - core 165 r3222 b35605a - H.264/MPEG-4 AVC codec - Copyleft 2003-2025 - http://www.videolan.org/x264.html - options: cabac=1 ref=5 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=8 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=2 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=18 lookahead_threads=3 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=3 weightb=1 open_gop=0 weightp=2 keyint=96 keyint_min=9 scenecut=40 intra_refresh=0 rc_lookahead=50 rc=crf mbtree=1 crf=17.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'D:\Projects\soccer-video\out\portrait_reels\2026-02-23__TSC_vs_NEOFC\.tmp.002__pipeline_v9.mp4':
  Metadata:
    encoder         : Lavf62.3.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1080x1920, q=2-31, 30 fps, 15360 tbn
    Metadata:
      encoder         : Lavc62.11.100 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0KiB time=N/A bitrate=N/A speed=N/A elapsed=0:00:00.51    frame=    0 fps=0.0 q=0.0 size=       0KiB time=N/A bitrate=N/A speed=N/A elapsed=0:00:01.02    frame=    0 fps=0.0 q=0.0 size=       0KiB time=N/A bitrate=N/A speed=N/A elapsed=0:00:01.55    frame=   15 fps=7.3 q=23.0 size=     768KiB time=00:00:00.43 bitrate=14519.6kbits/s speed=0.21x elapsed=0:00:02.06    frame=   18 fps=6.9 q=23.0 size=     768KiB time=00:00:00.53 bitrate=11797.2kbits/s speed=0.206x elapsed=0:00:02.59    frame=   23 fps=7.3 q=23.0 size=    1280KiB time=00:00:00.70 bitrate=14980.2kbits/s speed=0.223x elapsed=0:00:03.13    frame=   39 fps= 11 q=23.0 size=    2048KiB time=00:00:01.23 bitrate=13603.5kbits/s speed=0.336x elapsed=0:00:03.67    frame=   47 fps= 11 q=23.0 size=    2560KiB time=00:00:01.50 bitrate=13981.3kbits/s speed=0.356x elapsed=0:00:04.21    frame=   66 fps= 14 q=23.0 size=    3840KiB time=00:00:02.13 bitrate=14745.8kbits/s speed=0.451x elapsed=0:00:04.72    frame=   77 fps= 15 q=23.0 size=    4352KiB time=00:00:02.50 bitrate=14260.8kbits/s speed=0.477x elapsed=0:00:05.24    frame=   80 fps= 14 q=23.0 size=    4608KiB time=00:00:02.60 bitrate=14518.9kbits/s speed=0.451x elapsed=0:00:05.77    frame=  101 fps= 16 q=23.0 size=    5888KiB time=00:00:03.30 bitrate=14616.6kbits/s speed=0.525x elapsed=0:00:06.28    frame=  106 fps= 16 q=23.0 size=    6144KiB time=00:00:03.46 bitrate=14518.9kbits/s speed=0.509x elapsed=0:00:06.81    frame=  122 fps= 17 q=23.0 size=    7168KiB time=00:00:04.00 bitrate=14680.2kbits/s speed=0.545x elapsed=0:00:07.34    frame=  138 fps= 18 q=23.0 size=    8192KiB time=00:00:04.53 bitrate=14803.5kbits/s speed=0.576x elapsed=0:00:07.86    frame=  139 fps= 17 q=23.0 size=    8192KiB time=00:00:04.56 bitrate=14695.5kbits/s speed=0.545x elapsed=0:00:08.38    frame=  158 fps= 18 q=23.0 size=    9216KiB time=00:00:05.20 bitrate=14518.8kbits/s speed=0.583x elapsed=0:00:08.92    frame=  176 fps= 19 q=23.0 size=   10240KiB time=00:00:05.80 bitrate=14463.2kbits/s speed=0.614x elapsed=0:00:09.44    frame=  185 fps= 19 q=23.0 size=   10752KiB time=00:00:06.10 bitrate=14439.5kbits/s speed=0.612x elapsed=0:00:09.95    frame=  200 fps= 19 q=23.0 size=   11520KiB time=00:00:06.60 bitrate=14298.8kbits/s speed=0.63x elapsed=0:00:10.47    frame=  206 fps= 19 q=23.0 size=   12032KiB time=00:00:06.80 bitrate=14495.1kbits/s speed=0.618x elapsed=0:00:11.00    frame=  219 fps= 19 q=23.0 size=   12800KiB time=00:00:07.23 bitrate=14496.5kbits/s speed=0.627x elapsed=0:00:11.53    frame=  239 fps= 20 q=23.0 size=   13824KiB time=00:00:07.90 bitrate=14335.0kbits/s speed=0.655x elapsed=0:00:12.06    frame=  244 fps= 19 q=23.0 size=   14080KiB time=00:00:08.06 bitrate=14298.8kbits/s speed=0.641x elapsed=0:00:12.58    frame=  259 fps= 20 q=23.0 size=   14848KiB time=00:00:08.56 bitrate=14198.7kbits/s speed=0.654x elapsed=0:00:13.10    frame=  268 fps= 20 q=23.0 size=   15360KiB time=00:00:08.86 bitrate=14191.3kbits/s speed=0.651x elapsed=0:00:13.61    frame=  277 fps= 20 q=23.0 size=   15872KiB time=00:00:09.16 bitrate=14184.4kbits/s speed=0.648x elapsed=0:00:14.14    frame=  289 fps= 20 q=23.0 size=   16384KiB time=00:00:09.56 bitrate=14029.8kbits/s speed=0.653x elapsed=0:00:14.64    frame=  309 fps= 20 q=23.0 size=   17152KiB time=00:00:10.23 bitrate=13730.6kbits/s speed=0.675x elapsed=0:00:15.17    frame=  325 fps= 21 q=23.0 size=   18176KiB time=00:00:10.76 bitrate=13829.6kbits/s speed=0.686x elapsed=0:00:15.70    frame=  332 fps= 20 q=23.0 size=   18432KiB time=00:00:11.00 bitrate=13726.8kbits/s speed=0.678x elapsed=0:00:16.22    frame=  350 fps= 21 q=23.0 size=   19456KiB time=00:00:11.60 bitrate=13740.0kbits/s speed=0.693x elapsed=0:00:16.74    frame=  350 fps= 20 q=23.0 size=   19456KiB time=00:00:11.60 bitrate=13740.0kbits/s speed=0.671x elapsed=0:00:17.27    frame=  371 fps= 21 q=23.0 size=   20224KiB time=00:00:12.30 bitrate=13469.5kbits/s speed=0.691x elapsed=0:00:17.79    frame=  386 fps= 21 q=23.0 size=   21248KiB time=00:00:12.80 bitrate=13598.8kbits/s speed=0.699x elapsed=0:00:18.31    frame=  399 fps= 21 q=23.0 size=   21760KiB time=00:00:13.23 bitrate=13470.4kbits/s speed=0.702x elapsed=0:00:18.84    frame=  415 fps= 21 q=23.0 size=   22784KiB time=00:00:13.76 bitrate=13557.9kbits/s speed=0.711x elapsed=0:00:19.36    frame=  434 fps= 22 q=23.0 size=   24064KiB time=00:00:14.40 bitrate=13689.8kbits/s speed=0.724x elapsed=0:00:19.88    frame=  439 fps= 22 q=23.0 size=   24320KiB time=00:00:14.56 bitrate=13677.1kbits/s speed=0.714x elapsed=0:00:20.39    frame=  457 fps= 22 q=23.0 size=   25344KiB time=00:00:15.16 bitrate=13689.1kbits/s speed=0.725x elapsed=0:00:20.93    frame=  470 fps= 22 q=23.0 size=   25856KiB time=00:00:15.60 bitrate=13577.7kbits/s speed=0.728x elapsed=0:00:21.44    frame=  481 fps= 22 q=-1.0 size=   26624KiB time=00:00:15.96 bitrate=13660.0kbits/s speed=0.727x elapsed=0:00:21.96    [out#0/mp4 @ 0000025689dc7500] video:27670KiB audio:0KiB subtitle:0KiB other streams:0KiB global headers:0KiB muxing overhead: 0.021740%
frame=  496 fps= 22 q=-1.0 Lsize=   27676KiB time=00:00:16.46 bitrate=13768.6kbits/s speed=0.741x elapsed=0:00:22.20    
[libx264 @ 0000025689dd7380] frame I:10    Avg QP:16.68  size:263772
[libx264 @ 0000025689dd7380] frame P:268   Avg QP:19.66  size: 76796
[libx264 @ 0000025689dd7380] frame B:218   Avg QP:22.69  size: 23461
[libx264 @ 0000025689dd7380] consecutive B-frames: 34.3% 18.1%  9.7% 37.9%
[libx264 @ 0000025689dd7380] mb I  I16..4:  4.1% 88.2%  7.8%
[libx264 @ 0000025689dd7380] mb P  I16..4:  1.0%  8.0%  0.7%  P16..4: 37.7% 23.8% 12.2%  0.0%  0.0%    skip:16.5%
[libx264 @ 0000025689dd7380] mb B  I16..4:  0.1%  0.6%  0.1%  B16..8: 43.0% 10.8%  2.9%  direct: 5.7%  skip:36.7%  L0:41.9% L1:46.6% BI:11.6%
[libx264 @ 0000025689dd7380] 8x8 transform intra:83.3% inter:70.1%
[libx264 @ 0000025689dd7380] direct mvs  spatial:96.3% temporal:3.7%
[libx264 @ 0000025689dd7380] coded y,uvDC,uvAC intra: 80.9% 39.9% 20.5% inter: 33.2% 8.8% 0.4%
[libx264 @ 0000025689dd7380] i16 v,h,dc,p: 14% 74%  3% 10%
[libx264 @ 0000025689dd7380] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 11% 25%  9%  7%  8%  8%  9%  9% 13%
[libx264 @ 0000025689dd7380] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 12% 20%  7%  7% 11% 11% 11%  9% 13%
[libx264 @ 0000025689dd7380] i8c dc,h,v,p: 54% 26% 12%  8%
[libx264 @ 0000025689dd7380] Weighted P-Frames: Y:2.2% UV:0.4%
[libx264 @ 0000025689dd7380] ref P L0: 77.0%  7.5% 11.3%  2.5%  1.2%  0.4%  0.1%
[libx264 @ 0000025689dd7380] ref B L0: 90.2%  7.6%  1.8%  0.3%
[libx264 @ 0000025689dd7380] ref B L1: 97.7%  2.3%
[libx264 @ 0000025689dd7380] kb/s:13709.78
[VALIDATE] Checked 49 portrait frames: ball_detected=0, ball_missing=0, edge_warnings=0, corrections=0
[VALIDATE] Pass 1: PASSED â€” no corrections needed
[FFMPEG] Stitching frames from D:\Projects\soccer-video\out\_scratch\002__2026_02_23__TSC_vs_NEOFC__B_6180b164\autoframe_work\cinematic\002__2026-02-23__TSC_vs_NEOFC__BUILD_AND_SHOTS__t17.00-t32.00\frames -> D:\Projects\soccer-video\out\portrait_reels\2026-02-23__TSC_vs_NEOFC\002__pipeline_v9.mp4
[DONE] Video stitched successfully.

Exit code: 0
Output: D:\Projects\soccer-video\out\portrait_reels\2026-02-23__TSC_vs_NEOFC\002__pipeline_v9.mp4 (28.3 MB)
